This repo provides code for TeachText.

**Requirements:** The code assumes PyTorch 1.4 and Python 3.7 (other versions may work, but have not been tested).  See the section on dependencies towards the end of this file for specific package requirements.

**MSRVTT Benchmark**

| Model | Split | Task | R@1 | R@5 | R@10 | R@50 | MdR | MnR | Geom | Links |
| ----- | ------| ---- | --- | --- | ---- | ---- | --- | --- | --- | ----- |
| CE    | Full  | t2v  | <sub><sup>11.0<sub>(0.0)</sub></sup></sub> | <sub><sup>30.8<sub>(0.1)</sub></sup></sub> | <sub><sup>43.3<sub>(0.3)</sub></sup></sub> | <sub><sup>73.1<sub>(0.2)</sub></sup></sub> | <sub><sup>15.0<sub>(0.0)</sub></sup></sub> | <sub><sup>81.8<sub>(0.2)</sub></sup></sub> | <sub><sup>24.4<sub>(0.1)</sub></sup></sub> | [config](http:/www.robots.ox.ac.uk/~vgg/research/collaborative-experts/data/models/msrvtt-train-full-ce/6becbb74/seed-0/2020-06-28_18-31-21/config.json), [model](http:/www.robots.ox.ac.uk/~vgg/research/collaborative-experts/data/models/msrvtt-train-full-ce/6becbb74/seed-0/2020-06-28_18-31-21/trained_model.pth), [log](http:/www.robots.ox.ac.uk/~vgg/research/collaborative-experts/data/log/msrvtt-train-full-ce/6becbb74/seed-0/2020-06-28_18-31-21/summary-seed-0_seed-1_seed-2.json) |
| CE+    | Full  | t2v  | <sub><sup>13.8<sub>(0.1)</sub></sup></sub> | <sub><sup>36.5<sub>(0.2)</sub></sup></sub> | <sub><sup>49.4<sub>(0.4)</sub></sup></sub> | <sub><sup>77.6<sub>(0.2)</sub></sup></sub> | <sub><sup>11.0<sub>(0.0)</sub></sup></sub> | <sub><sup>69.4<sub>(0.8)</sub></sup></sub> | <sub><sup>29.2<sub>(0.2)</sub></sup></sub> | [config](http:/www.robots.ox.ac.uk/~vgg/research/collaborative-experts/data/models/msrvtt-train-gpt2-xl-finetuned-adam/244af891/seed-0/2020-10-01_12-22-00/config.json), [model](http:/www.robots.ox.ac.uk/~vgg/research/collaborative-experts/data/models/msrvtt-train-gpt2-xl-finetuned-adam/244af891/seed-0/2020-10-01_12-22-00/trained_model.pth), [log](http:/www.robots.ox.ac.uk/~vgg/research/collaborative-experts/data/log/msrvtt-train-gpt2-xl-finetuned-adam/244af891/seed-0/2020-10-01_12-22-00/summary-seed-0_seed-1_seed-2.json) |
| TeachText - CE    | Full  | t2v  | <sub><sup>11.8<sub>(0.1)</sub></sup></sub> | <sub><sup>32.7<sub>(0.2)</sub></sup></sub> | <sub><sup>45.3<sub>(0.2)</sub></sup></sub> | <sub><sup>74.9<sub>(0.1)</sub></sup></sub> | <sub><sup>13.0<sub>(0.0)</sub></sup></sub> | <sub><sup>74.9<sub>(0.4)</sub></sup></sub> | <sub><sup>25.9<sub>(0.1)</sub></sup></sub> | [config](http:/www.robots.ox.ac.uk/~vgg/research/collaborative-experts/data/models/msrvtt-train-ce-intra-mte/4d4508a2/seed-0/2020-11-06_17-27-00/config.json), [model](http:/www.robots.ox.ac.uk/~vgg/research/collaborative-experts/data/models/msrvtt-train-ce-intra-mte/4d4508a2/seed-0/2020-11-06_17-27-00/trained_model.pth), [log](http:/www.robots.ox.ac.uk/~vgg/research/collaborative-experts/data/log/msrvtt-train-ce-intra-mte/4d4508a2/seed-0/2020-11-06_17-27-00/summary-seed-0_seed-1_seed-2.json) |
| TeachText - CE+    | Full  | t2v  | <sub><sup>14.6<sub>(0.0)</sub></sup></sub> | <sub><sup>37.9<sub>(0.1)</sub></sup></sub> | <sub><sup>50.9<sub>(0.2)</sub></sup></sub> | <sub><sup>78.9<sub>(0.0)</sub></sup></sub> | <sub><sup>10.0<sub>(0.0)</sub></sup></sub> | <sub><sup>63.1<sub>(0.2)</sub></sup></sub> | <sub><sup>30.4<sub>(0.0)</sub></sup></sub> | [config](http:/www.robots.ox.ac.uk/~vgg/research/collaborative-experts/data/models/msrvtt-train-gpt2-xl-finetuned-mte-adam/6427fd41/seed-0/2020-09-30_20-34-12/config.json), [model](http:/www.robots.ox.ac.uk/~vgg/research/collaborative-experts/data/models/msrvtt-train-gpt2-xl-finetuned-mte-adam/6427fd41/seed-0/2020-09-30_20-34-12/trained_model.pth), [log](http:/www.robots.ox.ac.uk/~vgg/research/collaborative-experts/data/log/msrvtt-train-gpt2-xl-finetuned-mte-adam/6427fd41/seed-0/2020-09-30_20-34-12/summary-seed-0_seed-1_seed-2.json) |

**Denoising results on MSRVTT**

| Model | Split | Task | R@1 | R@5 | R@10 | R@50 | MdR | MnR | Geom | Links |
| ----- | ------| ---- | --- | --- | ---- | ---- | --- | --- | --- | ----- |
| CE+    | Full  | t2v  | <sub><sup>14.4<sub>(0.1)</sub></sup></sub> | <sub><sup>37.4<sub>(0.2)</sub></sup></sub> | <sub><sup>50.2<sub>(0.1)</sub></sup></sub> | <sub><sup>77.9<sub>(0.1)</sub></sup></sub> | <sub><sup>10.0<sub>(0.0)</sub></sup></sub> | <sub><sup>70.8<sub>(0.1)</sub></sup></sub> | <sub><sup>30.0<sub>(0.1)</sub></sup></sub> | [config](http:/www.robots.ox.ac.uk/~vgg/research/collaborative-experts/data/models/msrvtt-train-gpt2-xl-finetuned-denoising-adam/a61447a9/seed-0/2020-11-11_05-31-29/config.json), [model](http:/www.robots.ox.ac.uk/~vgg/research/collaborative-experts/data/models/msrvtt-train-gpt2-xl-finetuned-denoising-adam/a61447a9/seed-0/2020-11-11_05-31-29/trained_model.pth), [log](http:/www.robots.ox.ac.uk/~vgg/research/collaborative-experts/data/log/msrvtt-train-gpt2-xl-finetuned-denoising-adam/a61447a9/seed-0/2020-11-11_05-31-29/summary-seed-0_seed-1_seed-2.json) |
| TeachText - CE+    | Full  | t2v  | <sub><sup>14.9<sub>(0.1)</sub></sup></sub> | <sub><sup>38.3<sub>(0.1)</sub></sup></sub> | <sub><sup>51.5<sub>(0.1)</sub></sup></sub> | <sub><sup>79.2<sub>(0.1)</sub></sup></sub> | <sub><sup>10.0<sub>(0.0)</sub></sup></sub> | <sub><sup>62.5<sub>(0.5)</sub></sup></sub> | <sub><sup>30.9<sub>(0.1)</sub></sup></sub> | [config](http:/www.robots.ox.ac.uk/~vgg/research/collaborative-experts/data/models/msrvtt-train-gpt2-xl-finetuned-mte-denoising-adam/2cc98676/seed-0/2020-11-11_06-21-03/config.json), [model](http:/www.robots.ox.ac.uk/~vgg/research/collaborative-experts/data/models/msrvtt-train-gpt2-xl-finetuned-mte-denoising-adam/2cc98676/seed-0/2020-11-11_06-21-03/trained_model.pth), [log](http:/www.robots.ox.ac.uk/~vgg/research/collaborative-experts/data/log/msrvtt-train-gpt2-xl-finetuned-mte-denoising-adam/2cc98676/seed-0/2020-11-11_06-21-03/summary-seed-0_seed-1_seed-2.json) |